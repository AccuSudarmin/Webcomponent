
   <head>
      <link rel="stylesheet" href="./css/az-slide.css">
   </head>
   <body>
<script>
   (function() {
      var importDoc = document._currentScript.ownerDocument; // importee
      var allSlide = [];
      var currentSlide = 1;
      var hit = false
         hitTimeOut = null;
      var timeOutBefore = null
         , timeOutNow = null;

      var setSlide = function(slideNow, slideBefore){
         clearTimeout(timeOutBefore);
         clearTimeout(timeOutNow);

         var zindexNow = "2"
            , zindexBefore = "1";

         if (slideBefore) {

            if (slideNow > slideBefore) {
               var leftPositionBf = "-" + parseInt(allSlide[slideBefore-1].offsetWidth) + "px";
            } else {
               var leftPositionBf = parseInt(allSlide[slideBefore-1].offsetWidth) + "px";
            }

            allSlide[slideBefore-1].style.zIndex = zindexBefore;
            timeOutBefore = setTimeout(function () {
               allSlide[slideBefore-1].style.left = leftPositionBf;
               allSlide[slideBefore-1].style.display = "none";
            }, 1200);
         }

         allSlide[slideNow-1].style.display = "table";
         allSlide[slideNow-1].style.zIndex = zindexNow;

         if (slideNow < slideBefore) {
            var leftPosition = "-" + parseInt(allSlide[slideNow-1].offsetWidth) + "px";
         } else {
            var leftPosition = parseInt(allSlide[slideNow-1].offsetWidth) + "px";
         }

         allSlide[slideNow-1].style.left = leftPosition;

         timeOutNow = setTimeout(function () {
            allSlide[slideNow-1].style.left = "0px";
         }, 100);

         currentSlide = slideNow;

         location.hash = slideNow;
      }

      if (window.location.hash.substr(1)){
         currentSlide = parseInt(window.location.hash.substr(1));
      }

      // az-button js
      var azslide = Object.create(HTMLElement.prototype);

      azslide.createdCallback = function () {
         var title = this.querySelector("slide-title");
         var header = this.querySelector("header");
         var mainBackColor = this.getAttribute("color") || "white";
         var contentColor = this.getAttribute("contentColor") || "black";
         allSlide.push(this);

         this.style.backgroundColor = mainBackColor;
         this.style.color = contentColor;

         if (allSlide.length === currentSlide) {
            setSlide(currentSlide);
         } else {
            // this.style.opacity = 0;
            this.style.display = "none";
         }

         if (title) {
            var titleColor = title.getAttribute("color") || "black";
            title.style.color = titleColor;
         }

         if (header) {
            var headerColor = header.getAttribute("color") || "black";
            header.style.color = headerColor;
         }

      };

      document.registerElement('az-slide', {prototype: azslide});
      // end of js az-button

      var azcoding = Object.create(HTMLElement.prototype);

      azcoding.createdCallback = function () {
         var content = this.innerHTML;
         var code = {};

         code.def = {
            option: ["var", "function", "require"] ,
            open: "<span class='def-syntax'>" ,
            close: "</span>"
         }

         // code.string = {
         //    option: ["\\'(.*)\\'"] ,
         //    open: "<span class='string'>" ,
         //    close: "</span>"
         // }

         // var def = {"var" , "function", "require"};
         // def = new RegExp(def.join("|"),"gi");

         //    var obj = validation_messages[key];
         // for (var prop in obj) {
         //    // important check that this is objects own property
         //    // not from prototype prop inherited
         //    if(obj.hasOwnProperty(prop)){
         //      alert(prop + " = " + obj[prop]);
         //    }
         // }

         function joinAll(obj){
            var arr = {};
            for (var key in code) {
               if (code.hasOwnProperty(key)) {
                  var codeObj = code[key];

                  for (var i = 0; i < codeObj.option.length; i++) {
                     // arr.push(codeObj.option[i]);
                     var option = codeObj.option[i];
                     arr[option] = { name: option, open: codeObj.open , close: codeObj.close };
                  }
               }
            }

            return arr;
         }
         // console.log(JSON.stringify(joinAll(code)));
         var mapObj = joinAll(code);

         var re = new RegExp(Object.keys(mapObj).join("|"),"gi");

         // console.log(re);

         // var re = new RegExp(joinAll(code).join("|"),"gi");
         //
         content = content.replace(/\'(.*)\'|\"(.*)\"/gi, function(x){
            return "<span class='string'>" + x + "</span>";
         });

         content = content.replace(re, function(matched){
            return mapObj[matched].open + matched + mapObj[matched].close;
         });
         //
         //
         // content = content.replace(Object.keys(re))
         //if string

         //
         // //default syntax of javascript
         // content = content.replace(def, function(x){
         //    return "<span class='def-syntax'>" + x + "</span>";
         // });

         this.innerHTML = content;
      }

      document.registerElement('az-coding', {
         prototype: azcoding ,
         extends: "div"
      });

      document.body.addEventListener("keydown" , function(e){
         // console.log(e.keyCode);

         if (!hit) {
            switch (e.keyCode) {
               case 39:
                  if (currentSlide + 1 <= allSlide.length) {
                     var slideBefore = currentSlide;
                     var slideNow = currentSlide + 1;

                     setSlide(slideNow, slideBefore);
                  }
                  break;
               case 37:
                  if (currentSlide-1 >= 1) {
                     var slideBefore = currentSlide;
                     var slideNow = currentSlide - 1;

                     setSlide(slideNow, slideBefore);
                  }
                  break;
            }
            hit = true;
         }

         if (!hitTimeOut) {
            hitTimeOut = setTimeout(function () {
               hit = false;
               hitTimeOut = false;
            }, 1200);
         }
      });
   })();
</script>
